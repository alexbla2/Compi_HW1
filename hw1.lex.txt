%{
#include <stdio.h>
#include <string.h>
void showToken(char* );
%}

%option yylineno
%option noyywrap

digit ([0-9])
letter ([a-zA-Z])
alphaNum ([0-9a-zA-Z])
whitespace ([\t\n ])
newline 	(\r\n | \r | \n)
hexdig 		([0-9a-f])
octdig 		([0-7])


%x comment

%%


"---" 	showToken("STARTSTRUCT");
"..." 	showToken("ENDSTRUCT");
"[" 	showToken("LLIST");
"]"	    showToken("RLIST");
"{" 	showToken("LDICT");
"}"	    showToken("RDICT");
":" 	showToken("KEY");
"?"	    showToken("COMPLEXKEY");
"-"	    showToken("ITEM");
","	    showToken("COMMA");
"!!"{letter}+			showToken("TYPE");
"#"[^{newline}\n]* showToken("COMMENT");
true			showToken("TRUE");
false			showToken("FALSE");
("+"|"-")?{digit}+|0x{hexdig}+|0o{octdig}+	showToken("INTEGER");
(("+"|"-")?{digit}*.{digit}*)|(("+"|"-")?{digit}*.{digit}*e("+"|"-"){digit}+)|".inf"|".NaN" 	showToken("REAL");
{letter}+{alphaNum}+ 	showToken("VAL");
"&"{letter}+	showToken("DECLERATION");
"*"{letter}+	showToken("DEREFERENCE");
{whitespace}|{newline}	;
. printf("Error %s\n",yytext);exit(0);

%%

/*
int oct2int(char* oct, int len){
	int temp, num = 0, factor = 1;
	for(int i=len-1 ; i>1 ; i--){
		temp = oct[i] - 48;
		temp *= factor;
		num += temp;
		factor *= 8;
	}
	return num;
}

int hex2int(char* oct, int len){
	int temp, num = 0, factor = 1;
	for(int i=len-1 ; i>1 ; i--){
	//check if dig or letter
		temp = oct[i] - 48;
		temp *= factor;
		num += temp;
		factor *= 16;
	}
	return num;
}
*/
void showToken(char* str){
	if( strcmp(str ,"COMMENT") == 0 ){
		//cut the newline from comment
	}	
		
	printf("%d %s %s\n", yylineno, str, yytext);
}	

